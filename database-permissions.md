# 数据库权限配置说明

## 配置方式

数据库权限需要在微信云开发控制台进行配置。请按照以下步骤操作：

1. 登录 [微信云开发控制台](https://console.cloud.tencent.com/tcb)
2. 进入「数据库」->「权限设置」
3. 选择对应的集合，设置权限

## 权限配置

### 1. orders 集合权限

**读取权限：**
- 设置为：`所有用户可读`

**写入权限：**
- 设置为：`仅创建者可写`
- 或者使用自定义权限表达式：`doc._openid == auth.openid`

**说明：**
- 所有用户（包括司机和乘客）都可以读取所有订单
- 只有订单创建者（乘客）可以修改自己的订单
- 司机通过云函数更新订单状态（如接单），需要在云函数中使用管理员权限

### 2. bids 集合权限

**读取权限：**
- 设置为：`所有用户可读`

**写入权限：**
- 设置为：`仅创建者可写`
- 或者使用自定义权限表达式：`doc.driverOpenId == auth.openid`

**说明：**
- 所有用户都可以读取报价信息
- 只有报价创建者（司机）可以修改自己的报价
- 确保报价操作必须附带订单ID与司机OpenID

### 3. users 集合权限

**读取权限：**
- 设置为：`仅创建者可读`

**写入权限：**
- 设置为：`仅创建者可写`

**说明：**
- 保持严格权限模式，用户只能访问自己的信息

## 云函数权限

所有云函数默认拥有管理员权限，可以绕过数据库权限限制进行读写操作。

## 注意事项

1. 权限配置修改后需要等待几分钟生效
2. 建议在测试环境先验证权限配置
3. 如果遇到权限问题，检查云函数是否正确使用了管理员权限

